{% extends 'Backend/AppBase.html' %}
{% load templang %}
{% block page_title %}User - Dashboard{% endblock %}
{% block content %}
  <div class="container">
    <div class="row">
      <button type="button" data-toggle="modal" data-target="#addUser" class="btn btn-primary">New User</button>&nbsp
      <button type="button" data-toggle="modal" data-target="#batchImport" class="btn btn-primary">Batch Import</button>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Action</th>
            <th>_id</th>
            <th>Account</th>
            <th>Name</th>
            <th>Email</th>
          </tr>
        </thead>
        <tbody>
          {% for each in users %}
          <tr>
            <td><a href="/backend/user/A_DeleteI_{{ each | underscore:"id" }}/">Delete</a> / <a href="/backend/user/A_ModifyI_{{ each | underscore:"id" }}/">Modify</a></td>
            <td>{{ each | underscore:"id" }}</td>
            <td>{{ each.account }}</td>
            <td>{{ each.name }}</td>
            <td>{{ each.email }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <!-- BEGIN Add User Form -->
      {% include 'Backend/User/Forms/BatchImportForm.html' %}
      <!-- END Add User Form -->
      <!-- BEGIN Add User Form -->
      {% include 'Backend/User/Forms/AddUserForm.html' %}
      <!-- END Add User Form -->
      <!-- BEGIN Delete User Form -->
      {% include 'Backend/User/Forms/DelUserForm.html' %}
      <!-- END Delete User Form -->
      <!-- BEGIN Modify User Form -->
      {% include 'Backend/User/Forms/ModUserForm.html'  %}
      <!-- END Modify User Form -->
    </div>
  </div>
{% endblock %}
{% block body_bottom %}
  <script>
    function edit_passwd(checkBox) {
      var passwdField = document.getElementById('passwd');
      if(checkBox.checked) {
        passwdField.removeAttribute('disabled');
      } else {
        passwdField.value = '';
        passwdField.setAttribute('disabled', 'disabled');
      }
    }
    {% if action == 'Modify' %}
      $(window).on('load', function() {
        $('#modUser').modal('show');
      });
    {% elif action == 'Delete' %}
      $(window).on('load', function() {
        $('#delUser').modal('show');
      });
    {% endif %}
  </script>
{% endblock %}
